<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>
        Irvan789
    </title>
    <meta name="title" content="Genshin Impact Character Build">
    <meta name="description" content="Find What Best Build for Your Genshin Impact Character">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-ZCP2SQ0M8F" async></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-ZCP2SQ0M8F');
    </script>
</head>

<body style="background-color: #f3ebe1;">
    <section id="CharacterBuild" class="d-flex align-items-center">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 p-3">
                    <div class="character">
                        <div class="character-border">
                            <div class="character-body">
                                <div class="character-menu">
                                    <a href="./" class="menu-home" data-bs-toggle="tooltip" data-bs-placement="left"
                                        title="Home">
                                        <i class="fa-solid fa-house"></i>
                                    </a>
                                    <a href="javascript:void(0)" class="menu-link" data-bs-toggle="tooltip"
                                        data-bs-placement="left" title="Copy Link" onclick="copyLinkBuild()">
                                        <i class="fa-solid fa-link"></i>
                                    </a>
                                    <a href="https://github.com/Irvan789/GenshinBuild" class="menu-link"
                                        data-bs-toggle="tooltip" data-bs-placement="left" title="Github"
                                        target="_blank">
                                        <i class="fa-brands fa-github"></i>
                                    </a>
                                </div>
                                <div class="character-main">
                                    <div class="character-top load404">
                                        <!--Character Icon and Name-->
                                        <div class="character-name-level">
                                            <p class="character-name">
                                                Loading...
                                            </p>
                                        </div>
                                    </div>
                                    <div class="character-search">
                                        <form class="ms-auto text-right" autocomplete="off" style="max-width: 200px;">
                                            <div class="input-group mb-0">
                                                <input type="text" class="form-control" placeholder="Find Character"
                                                    name="name">
                                                <button class="btn text-white">
                                                    <i class="fa-solid fa-magnifying-glass"></i>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    <main>
                                        <!--Main Content Displayed in Here-->
                                    </main>
                                    <div class="character-copyright">
                                        &copy; 2022 | CrunchyNuts 800171178
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="modal fade" id="CharModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content text-white">
                <div class="modal-header border-bottom-0 shadow-sm">
                    <h6 class="modal-title fw-700"></h6>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="modal-img"></div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
        let urlQuery = new URLSearchParams(window.location.search);
        const copyLinkBuild = () => {
            const webURL = window.location.href;
            navigator.clipboard.writeText(webURL)
                .then(() => {
                    alert("Copy Link Successfully!");
                }).catch((error) => {
                    alert(error.message);
                })
        }
        if (urlQuery == null || !urlQuery.get("name")) {
            $(".character .character-top").html(`
                <div class="character-name-level">
                    <p class="character-name">
                        404 Not Found
                    </p>
                </div>
            `).addClass("load404");
            $(".character .character-main main").html(`
                <div class="row">
                    <div class="col-12 text-center fw-bold">
                        <div class="fs-4">
                            Oops, Something Wrong!
                        </div>
                    </div>
                </div>
            `);
            setTimeout(function () {
                location.href = `./`;
            }, 1000);
        } else {
            $(document).ready(function () {
                loadCharacterBuild(urlQuery.get("name"));
            });
            $(document).on("submit", "form", function (e) {
                e.preventDefault();
                let data = new FormData(this);
                loadCharacterBuild((data.get('name')).replace(/\s/g, '_'));
                history.pushState({}, "", `./character?name=${(data.get('name')).replace(/\s/g, '_')}`);
            });
            $(window).bind("popstate", function () {
                let urlQuery = new URLSearchParams(window.location.search);
                loadCharacterBuild(urlQuery.get("name"));
            });
            const loadCharacterBuild = (name) => {
                $.getJSON(`./assets/json/${name.toLowerCase()}.json`, function (data) {
                    $(document).attr("title", `Irvan789 | ${data.name}`);
                    $("meta[name=title]").attr("content", `Genshin Impact Character Build | ${data.name}`);
                    $(".character .character-top").html(`
                        <div class="character-icon" style="background-image: url('./assets/img/character/${(data.region).toLowerCase()}/${data.iconName}');"></div>
                        <img class="character-icon-border" src="./assets/img/border.png">
                        <div class="character-name-level">
                            <p class="character-name">
                                ${data.name}
                            </p>
                            <p class="character-level">
                                Level ${data.level} C${data.cons}
                            </p>
                        </div>
                    `).removeClass("load404");
                    $(".character .character-main main").html(`
                        <div class="row" style="padding: 0rem 0.75rem;">
                            <div class="col-12 build build-${name.toLowerCase()} shadow-sm">
                                <div class="d-stat me-auto">
                                    <table class="table table-stat table-borderless mb-0">
                                        <tr>
                                            <td>
                                                Max HP
                                            </td>
                                            <td>
                                                ${new Intl.NumberFormat('en-US').format(data.stat.HP)}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                ATK
                                            </td>
                                            <td>
                                                ${new Intl.NumberFormat('en-US').format(data.stat.ATK)}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                DEF
                                            </td>
                                            <td>
                                                ${new Intl.NumberFormat('en-US').format(data.stat.DEF)}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Elemental Mastery
                                            </td>
                                            <td>
                                                ${data.stat.EM}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Energy Recharge
                                            </td>
                                            <td>
                                                ${data.stat.ER}%
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Crit Rate / Crit DMG
                                            </td>
                                            <td>
                                                ${data.stat.CR}% / ${data.stat.CDM}%
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                Talent Level
                                            </td>
                                            <td>
                                                ${data.talents}
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div class="col-12 p-0">
                                <h3 class="fw-bold text-center mt-4 mb-4">
                                    Weapon & Artifact
                                </h3>
                                <div class="row row-card row-cols-2 row-cols-sm-3 g-0 m-auto">
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.weapon}" class="card-img-top" alt="Weapon">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.artifacts.flower}" class="card-img-top" alt="Flower of Life">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.artifacts.plume}" class="card-img-top" alt="Plume of Death">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.artifacts.eon}" class="card-img-top" alt="Sands of Eon">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.artifacts.goblet}" class="card-img-top" alt="Goblet of Eonothem">
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="card">
                                            <img src="${data.artifacts.circlet}" class="card-img-top" alt="Circlet of Logos">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `);
                    let modal = new bootstrap.Modal(document.getElementById('CharModal'));
                    $(document).on("click", ".card img", function () {
                        $(".modal .modal-title").html(`${data.name} | ${$(this).attr("alt")}`);
                        $(".modal .modal-img").css("background-image", `url('${$(this).attr("src")}')`);
                        modal.show();
                    });
                    $(document).on("click", ".modal .btn-close", function () {
                        modal.hide();
                    });
                }).fail(function () {
                    $(document).attr("title", `Irvan789 | 404 Not Found`);
                    $(".character .character-top").html(`
                        <div class="character-name-level">
                            <p class="character-name">
                                404 Not Found
                            </p>
                        </div>
                    `).addClass("load404");
                    $(".character .character-main main").html(`
                        <div class="row">
                            <div class="col-12 text-center fw-bold">
                                <div class="fs-4">
                                    Oops, Karakter "${(name).replace(/\W|_/g, " ")}" Tidak Di Temukan!
                                </div>
                            </div>
                        </div>
                    `);
                });
            }
        }
    </script>
</body>

</html>